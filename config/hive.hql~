-- Create a Hive database (if needed)
CREATE DATABASE IF NOT EXISTS bitcoin_data;

-- Use the created database
USE bitcoin_data;

-- Create a Hive table for Bitcoin price data
CREATE TABLE IF NOT EXISTS bitcoin_price (
    asset_id STRING,
    price DOUBLE,
    currency STRING,
    timestamp STRING,
    volume DOUBLE,
    market_cap DOUBLE,
    high24h DOUBLE,
    low24h DOUBLE
)
ROW FORMAT DELIMITED
FIELDS TERMINATED BY ','
STORED AS TEXTFILE;

-- Load initial data into the table (optional, if you have a CSV or other source)
-- Example of loading data from HDFS, if data is already stored in HDFS
-- LOAD DATA INPATH '/user/hadoop/bitcoin_price_data.csv' INTO TABLE bitcoin_price;

-- Example query: Show the top 10 latest prices for Bitcoin
SELECT * FROM bitcoin_price
WHERE asset_id = 'BTC'
ORDER BY timestamp DESC
LIMIT 10;

-- Example: Calculate the average Bitcoin price over a specific time period
SELECT AVG(price) AS avg_price FROM bitcoin_price
WHERE asset_id = 'BTC'
  AND timestamp BETWEEN '2024-01-01' AND '2024-12-31';

